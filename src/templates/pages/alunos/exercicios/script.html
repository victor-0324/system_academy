

<script>
    
    $(function() {
        
        $('#cadastrarProjeto').modal({
            backdrop: 'static',
            keyboard: false,
            show: false
        });
        
        $('#botaoAbrirModal').on('click', function() {
            $('#cadastrarProjeto').modal('show');
        });

        $('#cadastrar_ex').on('click', function() {
           

            var alunoId = $(this).data('aluno-id');
            $.ajax({
                url: '/alunos/exercicios/rest',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({
                    alunoId: alunoId,
                    tipoTreino: $("select[name='tipoTreino']").val(),
                    exercicio: $("input[name='exercicio']").val(),
                    serie: $("input[name='serie'").val(),
                    repeticao: $("input[name='repeticao']").val(),
                    descanso: $("input[name='descanso']").val(),
                    carga: $("input[name='carga']").val(),
                }),
                success: function(response) {
                    // Tratar a resposta do servidor
                    toastr.success('Exercício cadastrado com sucesso!', 'Sucesso');
                    setTimeout(function() {
                       window.location.reload();
                    }, 900);
                  

                },
                error: function(error) {
                    toastr.error('Aluno Não encontrado', 'Erro');
                }
         });
        });

        $(document).on('click', '#excluirExercicio', function() {
            var exercicioCardId = $(this).data('exercicio-card-id'); 
            $.ajax({
                url: '/alunos/exercicios/rest/' + exercicioCardId,
                type: 'DELETE',
                success: function(response) {
                    // Adicione este log para verificar a resposta no console
        
                    toastr.success('Exercício excluído com sucesso!', 'Sucesso');
                    setTimeout(function() {
                        location.reload();
                    }, 900); // Aguarde o tempo do toast antes de recarregar a página
                },
                error: function(error) {
                    // Adicione este log para verificar o erro no console
        
                    toastr.error('Houve um erro ao excluir o exercício.', error);
                }
            });
        });
    
        // Busca Por categoria 
        $(document).ready(function() {
            $('#searchForm').on('submit', function(e) {
                e.preventDefault(); // Impede o envio normal do formulário
        
                var alunoId = $('#alunoId').val();
                var searchOptions = $('#searchOptions').val();
                var categoriaId = $('#categoriaId').val();
        
                $.ajax({
                    url: '/alunos/atualizar_ex/'+ alunoId, // URL da sua rota
                    type: 'POST',
                    data: {
                        alunoId: alunoId,
                        searchOptions: searchOptions,
                        categoriaId: categoriaId
                    },
                    success: function(response) {
                        if (response.success) {
                        
                            toastr.success('Exercícios atualizados com sucesso!', 'Sucesso');
                            setTimeout(function() {
                                location.reload();
                            }, 900); 

                        } else {
                            toastr.error('Erro: ' + response.error);
                        }
                    },
                    error: function(xhr, status, error) {
                        alert('Falha ao atualizar exercícios');
                    }
                });
            });
        });
        
        //Date range picker
        $('#reservation').daterangepicker({
            locale: {
              format: 'DD/MM/YYYY'
            },
        });

        $(document).ready(function() {
            $('[id^="editarExercicio"]').on('click', function() {
                var exercicioId = $(this).data('exercicio-id');
        
                $.ajax({
                    url: `/alunos/editar/exercicio/${exercicioId}`,
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({
                        tipoTreino: $("#tipoTreino" + exercicioId).val(),
                        exercicio: $("#exercicioo" + exercicioId).val(),
                        serie: $("#serie" + exercicioId).val(),
                        repeticao: $("#repeticao" + exercicioId).val(),
                        descanso: $("#descanso" + exercicioId).val(),
                        carga: $("#carga" + exercicioId).val(),
                    }),
                    success: function(response) {
                        toastr.success('Exercício editado com sucesso!', 'success')
                        setTimeout(function() {
                           window.location.reload();
                        }, 900); 
                        
                    },
                    error: function(error) {
                        toastr.error('Houve algum problema em editar o exercício: ' + error.responseJSON.mensagem)
                    }
                });
            });
        });
        
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.filtro-status').forEach(function(item) {
            item.addEventListener('click', function(event) {
                event.preventDefault();
    
                var statusSelecionado = this.getAttribute('data-status');
                var cartoes = document.querySelectorAll('.card-aluno');
                console.log(cartoes)
                cartoes.forEach(function(cartao) {
                    if (cartao.getAttribute('data-status') === statusSelecionado || statusSelecionado === 'todos') {
                        cartao.style.display = ''; // Mostra o cartão
                    } else {
                        cartao.style.display = 'none'; // Esconde o cartão
                    }
                });
            });
        });
    }); 
</script>
  

    